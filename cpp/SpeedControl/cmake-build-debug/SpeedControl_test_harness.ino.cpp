// automatically generated by arduino-cmake
#line 1 "/home/graham/_Source/robot1/cpp/SpeedControl/test_harness.ino"
#include <Arduino.h>
#include <Servo>
#include "SpeedControl.h"

#define UPDATE_STEP_SIZE 50
#define ESC_PIN_NUMBER 3

#line 10 "/home/graham/_Source/robot1/cpp/SpeedControl/cmake-build-debug/SpeedControl_test_harness.ino.cpp"
#include "Arduino.h"

//=== START Forward: /home/graham/_Source/robot1/cpp/SpeedControl/test_harness.ino
 void setup() ;
 void setup() ;
 void loop() ;
 void loop() ;
//=== END Forward: /home/graham/_Source/robot1/cpp/SpeedControl/test_harness.ino
#line 6 "/home/graham/_Source/robot1/cpp/SpeedControl/test_harness.ino"


Servo esc;
SpeedControl tazer;

unsigned long loopStartMillis = 0;

void setup() {
    esc.attach(ESC_PIN_NUMBER);
    tazer.attach(esc, UPDATE_STEP_SIZE);
}

void loop() {
    loopStartMillis = millis();

    if (Serial.available() > 0) {
        int command = Serial.parseInt();

        if (tazer.getMillisUntilAvailableForCommand() <= 0) {
            tazer.commandMove(command);
        }
    }

    tazer.incrementStep();

    while (UPDATE_STEP_SIZE > (millis() - loopStartMillis))
    {
        delay(5);
    }

}