// automatically generated by arduino-cmake
#line 1 "/home/graham/Source/robot1/sketches/turretDebug/turretDebug.ino"
#include <Arduino.h>
#include <Arduino_FreeRTOS.h>
#include <task.h>
#include <TurretPins.h>
#include <Indicator.h>
#include <TraverseController.h>
#include <ElevationController.h>

#line 11 "/home/graham/Source/robot1/sketches/cmake-build-debug/Turret_turretDebug.ino.cpp"
#include "Arduino.h"

//=== START Forward: /home/graham/Source/robot1/sketches/turretDebug/turretDebug.ino
 void setup() ;
 void setup() ;
 void loop() ;
 void loop() ;
 void TaskElevationTest( void *pvParameters ) ;
 void TaskElevationTest( void *pvParameters ) ;
 void TaskTraverseTest( void *pvParameters ) ;
 void TaskTraverseTest( void *pvParameters ) ;
 void setArdStatusGood() ;
 void setArdStatusGood() ;
 void setArdStatusError() ;
 void setArdStatusError() ;
 void setPins() ;
 void setPins() ;
 boolean turnOffAllIndicators() ;
 boolean turnOffAllIndicators() ;
 void TaskIndicatorTest( void* pvParameters ) ;
 void TaskIndicatorTest( void* pvParameters ) ;
//=== END Forward: /home/graham/Source/robot1/sketches/turretDebug/turretDebug.ino
#line 7 "/home/graham/Source/robot1/sketches/turretDebug/turretDebug.ino"


void setPins();
boolean turnOffAllIndicators();
void setArdStatusGood();
void setArdStatusError();


TaskHandle_t xTaskHandleElevationTest = NULL;
void TaskElevationTest(void* pvParameters);

TaskHandle_t xTaskHandleIndicatorTest = NULL;
void TaskIndicatorTest(void* pvParameters);

TaskHandle_t xTaskHandleTraverseTest = NULL;
void TaskTraverseTest(void* pvParameters);

ElevationController* elevationController = new ElevationController();
TraverseController traverseController = TraverseController();

void setup() {
    setPins();

    if (turnOffAllIndicators()) {
        setArdStatusGood();
    } else {
        setArdStatusError();
    }
    xTaskCreate(
      TaskIndicatorTest
    ,  (const portCHAR *) "IndicatorTest"
    ,  128  // Stack size
    ,  NULL
    ,  1  // Priority
    ,  &xTaskHandleIndicatorTest );

  xTaskCreate(
    TaskTraverseTest
    ,  (const portCHAR *) "TraverseTest"
    ,  512  // Stack size
    ,  NULL
    ,  1  // Priority
    ,  &xTaskHandleTraverseTest);
    
  xTaskCreate(
    TaskElevationTest
    ,  (const portCHAR *) "ElevationTest"
    ,  512  // Stack size
    ,  NULL
    ,  1  // Priority
    ,  &xTaskHandleElevationTest);
}

void loop() {

}

void TaskElevationTest( void *pvParameters ) {
    for (int idx = 0; idx < 2; idx++) {
        elevationController->demoFunctionCheck();
    }
    vTaskDelete(NULL);
}


void TaskTraverseTest( void *pvParameters ) {
    //TraverseController traverseController = TraverseController();
    
    for (int idx = 0; idx < 2; idx++) { 
        traverseController.functionCheckDemo();
    }
    vTaskDelete(xTaskHandleTraverseTest);
}

void setArdStatusGood() {
    Indicator::turnOffLed(ARD_STATUS_RED);
    Indicator::turnOnLed(ARD_STATUS_GRN);
}

void setArdStatusError() {
    Indicator::turnOffLed(ARD_STATUS_GRN);
    Indicator::turnOnLed(ARD_STATUS_RED);
}

void setPins() {
    pinMode(ELEVATION_MOTOR_ENABLE, OUTPUT);
    pinMode(ELEVATION_MOTOR_POS, OUTPUT);
    pinMode(ELEVATION_MOTOR_NEG, OUTPUT);

    pinMode(ARD_STATUS_GRN, OUTPUT);
    pinMode(ARD_STATUS_RED, OUTPUT);

    pinMode(ACTY_LED_1, OUTPUT);
    pinMode(ACTY_LED_2, OUTPUT);
    pinMode(ACTY_LED_3, OUTPUT);

    pinMode(MOVE_LED_GRN, OUTPUT);
    pinMode(MOVE_LED_RED, OUTPUT);
    pinMode(MOVE_LED_BLUE, OUTPUT);

    pinMode(CANNON_LED, OUTPUT);
}

boolean turnOffAllIndicators() {
    Indicator::turnOffLed(ARD_STATUS_GRN);
    Indicator::turnOffLed(ARD_STATUS_RED);

    Indicator::turnOffLed(ACTY_LED_1);
    Indicator::turnOffLed(ACTY_LED_2);
    Indicator::turnOffLed(ACTY_LED_3);

    Indicator::turnOffLed(MOVE_LED_GRN);
    Indicator::turnOffLed(MOVE_LED_RED);
    Indicator::turnOffLed(MOVE_LED_BLUE);

    Indicator::turnOffLed(CANNON_LED);

    return true;
}

// Declare the thread function for TaskIndicatorTest
void TaskIndicatorTest( void* pvParameters ) {

  Indicator::alertBlinkFast(ACTY_LED_1);
  Indicator::alertBlinkFast(ACTY_LED_2);
  Indicator::alertBlinkFast(ACTY_LED_3);

  Indicator::alertStrobeSlow(MOVE_LED_GRN);
  Indicator::alertStrobeSlow(MOVE_LED_RED);
  Indicator::alertStrobeSlow(MOVE_LED_BLUE);

  
  vTaskDelete(xTaskHandleIndicatorTest);
}

